import React, { useEffect, useState } from 'react';\nimport { useTranslation } from '../contexts/TranslationContext';\n\n// Higher-order component that automatically translates all text content\nexport const withAutoTranslation = (WrappedComponent) => {\n  return function AutoTranslatedComponent(props) {\n    const { translateContent, language } = useTranslation();\n    const [translatedProps, setTranslatedProps] = useState(props);\n    const [isTranslating, setIsTranslating] = useState(false);\n\n    useEffect(() => {\n      if (language === 'en') {\n        setTranslatedProps(props);\n        return;\n      }\n\n      const translateProps = async () => {\n        setIsTranslating(true);\n        try {\n          const translated = await deepTranslateObject(props, translateContent, language);\n          setTranslatedProps(translated);\n        } catch (error) {\n          console.error('Translation error:', error);\n          setTranslatedProps(props);\n        } finally {\n          setIsTranslating(false);\n        }\n      };\n\n      translateProps();\n    }, [props, language, translateContent]);\n\n    return <WrappedComponent {...translatedProps} isTranslating={isTranslating} />;\n  };\n};\n\n// Deep translate object properties\nconst deepTranslateObject = async (obj, translateFn, targetLang) => {\n  if (typeof obj === 'string') {\n    // Only translate if it's meaningful text (not URLs, IDs, etc.)\n    if (shouldTranslateString(obj)) {\n      return await translateFn(obj, targetLang);\n    }\n    return obj;\n  }\n  \n  if (Array.isArray(obj)) {\n    return Promise.all(obj.map(item => deepTranslateObject(item, translateFn, targetLang)));\n  }\n  \n  if (obj && typeof obj === 'object') {\n    const translated = {};\n    for (const [key, value] of Object.entries(obj)) {\n      // Skip certain keys that shouldn't be translated\n      if (shouldSkipKey(key)) {\n        translated[key] = value;\n      } else {\n        translated[key] = await deepTranslateObject(value, translateFn, targetLang);\n      }\n    }\n    return translated;\n  }\n  \n  return obj;\n};\n\n// Check if a string should be translated\nconst shouldTranslateString = (str) => {\n  if (!str || typeof str !== 'string') return false;\n  \n  // Skip URLs, emails, IDs, etc.\n  const skipPatterns = [\n    /^https?:\\/\\//,  // URLs\n    /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/, // Emails\n    /^[a-f0-9]{24}$/, // MongoDB ObjectIds\n    /^\\d+$/, // Pure numbers\n    /^[A-Z_]+$/, // Constants\n    /\\.(jpg|jpeg|png|gif|webp|svg|pdf|doc|docx)$/i, // File extensions\n  ];\n  \n  return !skipPatterns.some(pattern => pattern.test(str)) && str.length > 1;\n};\n\n// Keys that should not be translated\nconst shouldSkipKey = (key) => {\n  const skipKeys = [\n    '_id', 'id', 'userId', 'createdAt', 'updatedAt', 'email', 'password',\n    'token', 'url', 'src', 'href', 'className', 'style', 'key', 'ref',\n    'onClick', 'onChange', 'onSubmit', 'type', 'method', 'status', 'code'\n  ];\n  \n  return skipKeys.includes(key) || key.startsWith('on') || key.startsWith('_');\n};\n\n// Hook for manual translation of dynamic content\nexport const useAutoTranslate = () => {\n  const { translateContent, language } = useTranslation();\n  \n  const translateText = async (text) => {\n    if (language === 'en' || !shouldTranslateString(text)) {\n      return text;\n    }\n    return await translateContent(text, language);\n  };\n  \n  const translateArray = async (array) => {\n    return Promise.all(array.map(item => \n      typeof item === 'string' ? translateText(item) : item\n    ));\n  };\n  \n  return { translateText, translateArray, language };\n};